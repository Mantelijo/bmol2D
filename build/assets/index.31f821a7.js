var Wt=Object.defineProperty;var rt=Object.getOwnPropertySymbols;var Gt=Object.prototype.hasOwnProperty,Ht=Object.prototype.propertyIsEnumerable;var Oe=(t,e,r)=>e in t?Wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Re=(t,e)=>{for(var r in e||(e={}))Gt.call(e,r)&&Oe(t,r,e[r]);if(rt)for(var r of rt(e))Ht.call(e,r)&&Oe(t,r,e[r]);return t};var jt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var S=(t,e,r)=>(Oe(t,typeof e!="symbol"?e+"":e,r),r);import{j as Le,r as Y,m as it,l as $t,s as qt,a as De,d as Yt,z as Vt,i as Kt,b as Xt,R as Fe,c as Jt,e as Qt,f as Zt}from"./vendor.790e3e98.js";var rr=jt((sr,et)=>{const en=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=r(s);fetch(s.href,c)}};en();class m{constructor(e,r,i){this.x=e,this.y=r,this.z=i,this.x=e||0,this.y=r||0,this.z=i||0}negative(){return new m(-this.x,-this.y,-this.z)}add(e){return e instanceof m?new m(this.x+e.x,this.y+e.y,this.z+e.z):new m(this.x+e,this.y+e,this.z+e)}subtract(e){return e instanceof m?new m(this.x-e.x,this.y-e.y,this.z-e.z):new m(this.x-e,this.y-e,this.z-e)}multiply(e){return e instanceof m?new m(this.x*e.x,this.y*e.y,this.z*e.z):new m(this.x*e,this.y*e,this.z*e)}divide(e){return e instanceof m?new m(this.x/e.x,this.y/e.y,this.z/e.z):new m(this.x/e,this.y/e,this.z/e)}equals(e){return this.x==e.x&&this.y==e.y&&this.z==e.z}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){return new m(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}length(){return Math.sqrt(this.dot(this))}magnitude(){return this.length()}unit(){return this.divide(this.length())}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toAngles(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}}angleTo(e){return Math.acos(this.dot(e)/(this.length()*e.length()))}toArray(e){return[this.x,this.y,this.z].slice(0,e||3)}toCoord(){return new xe(this.x,this.y,this.z)}clone(){return new m(this.x,this.y,this.z)}init(e,r,i){return this.x=e,this.y=r,this.z=i,this}normalize(){return this.unit()}setIndex(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break}}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)+Math.pow(this.z-e.z,2))}static negative(e,r,i){return r.x=-e.x,r.y=-e.y,r.z=-e.z,r}static add(e,r,i){return r instanceof m?(i.x=e.x+r.x,i.y=e.y+r.y,i.z=e.z+r.z):(i.x=e.x+r,i.y=e.y+r,i.z=e.z+r),i}static subtract(e,r,i){return r instanceof m?(i.x=e.x-r.x,i.y=e.y-r.y,i.z=e.z-r.z):(i.x=e.x-r,i.y=e.y-r,i.z=e.z-r),i}static multiply(e,r,i){return r instanceof m?(i.x=e.x*r.x,i.y=e.y*r.y,i.z=e.z*r.z):(i.x=e.x*r,i.y=e.y*r,i.z=e.z*r),i}static divide(e,r,i){return r instanceof m?(i.x=e.x/r.x,i.y=e.y/r.y,i.z=e.z/r.z):(i.x=e.x/r,i.y=e.y/r,i.z=e.z/r),i}static cross(e,r,i){return i.x=e.y*r.z-e.z*r.y,i.y=e.z*r.x-e.x*r.z,i.z=e.x*r.y-e.y*r.x,i}static unit(e,r,i){var s=e.length();return r.x=e.x/s,r.y=e.y/s,r.z=e.z/s,r}static fromAngles(e,r){return new m(Math.cos(e)*Math.cos(r),Math.sin(r),Math.sin(e)*Math.cos(r))}static randomDirection(){return m.fromAngles(Math.random()*Math.PI*2,Math.asin(Math.random()*2-1))}static min(e,r,i){return new m(Math.min(e.x,r.x),Math.min(e.y,r.y),Math.min(e.z,r.z))}static max(e,r,i){return new m(Math.max(e.x,r.x),Math.max(e.y,r.y),Math.max(e.z,r.z))}static lerp(e,r,i){return r.subtract(e).multiply(i).add(e)}static fromArray(e){return new m(e[0],e[1],e[2])}static angleBetween(e,r,i){return e.angleTo(r)}static infinity(){return new m(1/0,1/0,1/0)}}class xe{constructor(e,r,i){this.x=e,this.y=r,this.z=i}toVec(){return m.fromArray(this.toArray())}toArray(){return[this.x,this.y,this.z]}}var at;(function(t){t.A="\u03B1",t.B="\u03B2",t.G="\u03B3",t.D="\u03B4",t.E="\u03B5",t.Z="\u03B6",t.H="\u03B7"})(at||(at={}));class tn{constructor(){S(this,"center");S(this,"interactions");S(this,"atoms");S(this,"v");S(this,"o");S(this,"hash");S(this,"name");S(this,"sequenceNumber");S(this,"polymerChainIdentifier");S(this,"initial_x");S(this,"initial_y");this.atoms=[],this.name="",this.sequenceNumber=-1,this.center=new xe(-1,-1,-1),this.hash="",this.interactions=[],this.polymerChainIdentifier="",this.v=m.infinity(),this.o=m.infinity(),this.initial_x=0,this.initial_y=0}findAtomsByNames(e){const r=[];return this.atoms.forEach(i=>{e.indexOf(i.name)!==-1&&r.push(i)}),r.sort((i,s)=>e.indexOf(i.name)-e.indexOf(s.name)),r}}var E;(function(t){t.DA="DA",t.DG="DG",t.DC="DC",t.DT="DT",t.CM="5CM"})(E||(E={}));var _;(function(t){t.A="A",t.C="C",t.G="G",t.I="I",t.U="U"})(_||(_={}));var st;(function(t){t[t.Ala=0]="Ala",t[t.Arg=1]="Arg",t[t.Asn=2]="Asn",t[t.Asp=3]="Asp",t[t.Cys=4]="Cys",t[t.Glu=5]="Glu",t[t.Gln=6]="Gln",t[t.Gly=7]="Gly",t[t.His=8]="His",t[t.Ile=9]="Ile",t[t.Leu=10]="Leu",t[t.Lys=11]="Lys",t[t.Met=12]="Met",t[t.Phe=13]="Phe",t[t.Pro=14]="Pro",t[t.Ser=15]="Ser",t[t.Thr=16]="Thr",t[t.Trp=17]="Trp",t[t.Tyr=18]="Tyr",t[t.Val=19]="Val"})(st||(st={}));var D;(function(t){t.DNA="DNA",t.RNA="RNA",t.Protein="Protein",t.Unknown="Unknown"})(D||(D={}));function nn(t){switch(!0){case t.residueName in E:return D.DNA;case t.residueName in _:return D.RNA;default:return D.Protein}}function ot(t){return`${t.residueName}${t.residueSequenceNumber}:${t.name}`}const p=Le.exports.jsx,T=Le.exports.jsxs,rn=Le.exports.Fragment,Pe={polymers:[],pdb:void 0,isLoading:!1,simpleStuffy:"",hashedNucleicAcidResidues:{},viz:{chain1:null,chain2:null},currentPDBId:"",error:"",selectedResidueHash:void 0,getResidue:function(t,e){if(this.polymers.length===0)return null;const r=this.polymers.filter(i=>i.chainIdentifier===t);if(r.length>0){const i=r[0].residues.filter(s=>s.hash===e);if(i.length>0)return i[0]}return null}},ve=Y.exports.createContext([Pe,()=>{}]),an=(t,{type:e,payload:r})=>{switch(e){case"resetState":return Re({},Pe);default:if(e in t)t[e]=r;else throw new Error(`${e} not found in state`)}return Re({},t)},sn=({children:t})=>{const[e,r]=Y.exports.useReducer(an,Pe);return p(ve.Provider,{value:[e,r],children:t})};function lt(t){return t.residues.forEach((e,r)=>{const i=new xe(0,0,0);e.atoms.forEach(s=>{i.x+=s.coords.x,i.y+=s.coords.y,i.z+=s.coords.z}),i.x=i.x/e.atoms.length,i.y=i.y/e.atoms.length,i.z=i.z/e.atoms.length,t.residues[r].center=i}),t}var ze;(function(t){t[t.Threshold=0]="Threshold",t[t.HBond=1]="HBond"})(ze||(ze={}));const on=1.42,ct=t=>{if([D.DNA,D.RNA].indexOf(t.kind)!=-1){let e=["C2","C4","C6"];t.residues.forEach(r=>{let i=[];if(r.findAtomsByNames(e).forEach((c,o)=>{i[o]=c.coords}),i.length===3){const c=m.fromArray(i[0].toArray()),o=m.fromArray(i[1].toArray()),l=m.fromArray(i[2].toArray()),f=o.subtract(c).cross(l.subtract(c)).normalize(),u=c.add(o).add(l).divide(3);r.v=f,r.o=u}})}return t};function ft(t,e){const r=[[E.DA,E.DT],[E.DA,_.U],[E.DT,_.A],[E.DC,E.DG],[E.DC,_.G],[E.DG,E.DC],[E.DG,_.C],[_.C,_.G],[_.A,_.U],[E.CM,E.DG],[E.CM,_.G],[_.C,_.U]];for(let i=0;i<r.length;i++)if(t.name===r[i][0]&&e.name===r[i][1]||t.name===r[i][1]&&e.name===r[i][0])return!0;return!1}const X=t=>`${t.polymerChainIdentifier}:${t.name}${t.sequenceNumber}`;class ln{constructor(e){S(this,"nucleicAcids",[]);S(this,"proteins",[]);S(this,"hasValidDNA",!1);S(this,"hasValidRNA",!1);S(this,"residues",new Map);S(this,"visualization",{chain1:null,chain2:null});this.polymers=e,this.prepareObjects()}generateWatsonCrickPairs(e,r){let i=this.calculateWatsonCrickPairs(e,r),s=this.calculateWatsonCrickPairs(r,e);s.reverse();let c=i;return s.forEach(o=>{if(o.length===1)c.push(o);else if(o.length===2){let l=!1;for(let f=0;f<i.length;f++){let u=i[f];if(u.length===2&&u[0].hash===o[1].hash&&u[1].hash===o[0].hash){l=!0;break}}l||console.log(`watsonCrickPairs: matching pair was not found ${o[1].polymerChainIdentifier}:${o[1].sequenceNumber}${o[1].name}---${o[0].polymerChainIdentifier}:${o[0].sequenceNumber}${o[0].name}`,o)}}),c}watsonCrickPairs(){if(this.nucleicAcids.length<=0)throw Error("Nucleic acids are not initialized");let e=[];for(let r=0;r<this.nucleicAcids.length;r++){for(let s=r+1;s<this.nucleicAcids.length;s++){const c=this.generateWatsonCrickPairs(this.nucleicAcids[r],this.nucleicAcids[s]);e.push(...c)}const i=this.generateWatsonCrickPairs(this.nucleicAcids[r],this.nucleicAcids[r]);i.length>0&&(console.log("SIMILAR PAIRS",i),e.push(...i))}return e}calculateWatsonCrickPairs(e,r){let i=[];return e.residues.forEach(s=>{let c=1/0,o;if(r.residues.forEach(l=>{let f=1/0,u=[1/0],I=[1/0];const y=s.findAtomsByNames(["C2","C4","C6"]);y.length==3&&(u=[Math.abs(y[0].coords.toVec().subtract(l.o).dot(l.v)),Math.abs(y[1].coords.toVec().subtract(l.o).dot(l.v)),Math.abs(y[2].coords.toVec().subtract(l.o).dot(l.v))]);const M=l.findAtomsByNames(["C2","C4","C6"]);M.length==3&&(I=[Math.abs(M[0].coords.toVec().subtract(s.o).dot(s.v)),Math.abs(M[1].coords.toVec().subtract(s.o).dot(s.v)),Math.abs(M[2].coords.toVec().subtract(s.o).dot(s.v))]),f=Math.max(...I,...u),f<c&&s.hash!==l.hash&&(c=f,o=l)}),o!==void 0&&c<=on+Math.random()&&ft(o,s)&&s.center.toVec().distanceTo(o.center.toVec())<15){i.push([s,o]);const l=o;console.log("Smallest distance: ",`${e.kind}-${s.polymerChainIdentifier}:${s.sequenceNumber}${s.name}`,`${r.kind}-${l.polymerChainIdentifier}:${l.sequenceNumber}${l.name}`,c,ft(o,s))}else i.push([s]),console.log(`No pair for: ${e.kind} ${s.polymerChainIdentifier}:${s.sequenceNumber}${s.name}, smallest distance: ${c}`,o)}),i}prepareObjects(){this.nucleicAcids=this.findNucleicAcids(),this.proteins=this.findProteins(),this.nucleicAcids.forEach(e=>{lt(e),this.populateResiduesMap(e)}),this.proteins.forEach(e=>{lt(e),this.populateResiduesMap(e)})}findProteins(){return this.polymers.filter(e=>[D.Protein].indexOf(e.kind)!==-1)}findNucleicAcids(){return this.polymers.filter(e=>[D.DNA,D.RNA].indexOf(e.kind)!==-1)}populateResiduesMap(e){e.residues.forEach(r=>this.residues.set(r.hash,r))}findResidueByHash(e){return this.residues.get(e)}simpleInteractions(){const e=4,r=10;this.nucleicAcids.forEach(i=>{i.residues.forEach(s=>{this.proteins.forEach(c=>{c.residues.forEach(o=>{let l=o.findAtomsByNames(["CA"]);if(l.length>0){const f=l[0],u=s.center.toVec().distanceTo(f.coords.toVec());u<=r&&(console.log(`Possible interaction between: ${X(o)} and ${X(s)} (${u})`),s.atoms.forEach(I=>{o.atoms.forEach(y=>{const M=I.coords.toVec().distanceTo(y.coords.toVec());if(M<=e){console.log(`	Interaction between: ${ot(y)} and ${ot(I)} (${M})`);const j={polymerKind:D.Protein,type:ze.Threshold,polymerChainIdentifier:o.polymerChainIdentifier,residueHash:o.hash,atom:y};s.interactions.push(j)}})}))}})})})})}}var oe;(function(t){t.Residue="residue",t.InteractionsNumber="interactions_number",t.InteractionResidue="interaction_residue"})(oe||(oe={}));var J;(function(t){t.Pair="pair",t.Backbone="backbone",t.Interaction="interaction"})(J||(J={}));const be={size:10,y:4},cn=100,ue=9;function fn({nodes:t,links:e,svgRef:r,dispatch:i},s){let{nodeId:c=d=>d.id,nodeGroups:o,nodeTitle:l,nodeFill:f=d=>d.color!==void 0?d.color:"currentColor",nodeStroke:u="#fff",nodeStrokeWidth:I=1.5,nodeStrokeOpacity:y=1,linkStroke:M=d=>d.color!==void 0?d.color:"#444",linkStrokeOpacity:j=.6,linkStrokeWidth:x=1.5,linkStrokeLinecap:w="round",width:C=640,height:b=400,invalidation:A}=s;const g=t,O=e,P=it(t,c).map(Ft);l===void 0&&(l=(d,W)=>P[W]);const v=typeof x!="function"?null:it(e,x);t=g,e=O;const R=Xt(),Z=$t(e).id(({index:d})=>P[d]).distance((d,W)=>{switch(O[W].linkType){case J.Backbone:return 4;case J.Interaction:return 10;default:return 30}}).strength((d,W)=>{switch(O[W].linkType){case J.Backbone:return 1.8;case J.Interaction:return 1;default:return 1.2}}),L=qt(t).force("link",Z).force("nodes",R).on("tick",Pt),k=De(r).attr("width",C).attr("height",b).attr("viewBox",[-C/2,-b/2,C,b]).attr("style","max-width: 100%; height: auto; height: intrinsic;");k.html("");const V=k.append("g"),$=V.append("g").attr("stroke-opacity",j).attr("stroke-width",typeof x!="function"?x:null).attr("stroke-linecap",w).selectAll("line").data(e).join("line").attr("stroke-dasharray",d=>d.linkType==="pair"?"4":null).attr("stroke",M),se=V.append("g").selectAll("g").data(t).enter().append("g").call(zt(L)),B=se.append("circle").attr("stroke",u).attr("stroke-opacity",y).attr("stroke-width",I).attr("fill",f).style("cursor","pointer").attr("r",ue);let q=new Date;se.on("click",function(d,W){W.type&&[oe.InteractionsNumber,oe.Residue].indexOf(W.type)!==-1&&(i({type:"selectedResidueHash",payload:W.hash}),console.log("Clicked interaction bubble"))}).on("mouseover",function(d,W){De(this).select("circle").attr("r",tt(ue*2)),new Date().getTime()-q.getTime()>cn&&(q=new Date)}).on("mouseout",function(d,W){De(this).select("circle").attr("r",tt(ue))});const Ne=se.append("text").text(d=>d.name).attr("text-anchor","middle").attr("font-size",be.size).attr("y",be.y).attr("class","svg-graph-text");v&&$.attr("stroke-width",d=>v[d.index]),A!=null&&A.then(()=>L.stop());function Ft(d){return d!==null&&typeof d=="object"?d.valueOf():d}function Pt(){$.attr("x1",d=>d.initial_x).attr("y1",d=>d.initial_y).attr("x2",d=>d.initial_x).attr("y2",d=>d.initial_y),se.attr("transform",d=>`translate(${d.initial_x}, ${d.initial_y})`)}function zt(d){function W(z){z.active||d.alphaTarget(.3).restart(),z.subject.fx=z.subject.x,z.subject.fy=z.subject.y}function Ut(z){z.subject.fx=z.x,z.subject.fy=z.y}function Bt(z){z.active||d.alphaTarget(0),z.subject.fx=null,z.subject.fy=null}return Yt().on("start",W).on("drag",Ut).on("end",Bt)}const tt=d=>ee?d/ee:d;let ke,ee;const nt=Vt().on("zoom",d=>{requestAnimationFrame(()=>{V.attr("transform",ke=d.transform),ke&&(ee=Math.sqrt(ke.k),V.style("stroke-width",3/ee),B.attr("r",ue/ee).attr("stroke-width",I/ee),Ne.attr("font-size",be.size/ee).attr("y",be.y/ee))})});return k.call(nt).call(nt.transform,Kt),Object.assign(k.node(),{scales:{color:null}})}const ut={[E.DA]:"#fcb331",[E.DT]:"#5670fb",[E.DG]:"#f63c37",[E.DC]:"#03c907",[E.CM]:"#03c907",[_.A]:"#acb331",[_.U]:"#a670fb",[_.G]:"#a63c37",[_.C]:"#a3c907",[_.I]:"#a3c907",interaction:"#333"},Ee="red",le="blue",dt={[E.DA]:Ee,[E.DT]:Ee,[E.DG]:le,[E.DC]:le,[E.CM]:le,[_.A]:Ee,[_.U]:Ee,[_.G]:le,[_.C]:le,[_.I]:le,interaction:"#718355"},un="#494949";function dn(){const[t,e]=Y.exports.useContext(ve),r=t.polymers,i=Fe.createRef(),s=Fe.createRef(),c=Y.exports.useRef(null),o=Y.exports.useMemo(()=>{if(r.length>0){const u=new ln(r);return window.iFinder=u,u}},[r]);function l(){if(!i||r.length<=0||!o)return;console.time("Nucleic_acid_VIZ");let u;try{u=o.watsonCrickPairs()}catch(w){console.log(w),e({type:"error",payload:w.toString()});return}o.simpleInteractions();const I=[],y=[],M=w=>{const C=Object.values(E);w.residues.forEach((b,A)=>{I.push({hash:b.hash,name:b.name.toString().slice(-1),id:X(b),color:ut[b.name],group:C.indexOf(b.name)+1,type:oe.Residue,initial_x:b.initial_x,initial_y:b.initial_y});const g=w.residues;if(A>0&&A<g.length&&y.push({source:X(g[A-1]),target:X(b),value:1,color:un,linkType:J.Backbone}),b.interactions.length>0){const O=X(b)+"-interactions";I.push({hash:b.hash,name:b.interactions.length.toString(),id:O,color:ut.interaction,group:5,type:oe.InteractionsNumber}),y.push({source:O,target:X(b),value:1,color:dt.interaction,linkType:J.Interaction})}})};o.nucleicAcids.forEach(w=>M(w)),u.forEach(w=>{const C=w[0];if(w.length===2){const b=w[1];y.push({source:X(b),target:X(C),value:1,color:dt[C.name],linkType:J.Pair})}}),console.log("Vizualization data:",I,y);const[j,x]=[c.current.offsetWidth,c.current.offsetHeight];fn({nodes:I,links:y,svgRef:i.current,dispatch:e},{width:j,height:x}),console.timeEnd("Nucleic_acid_VIZ")}Y.exports.useEffect(l,[r]);const f=Y.exports.useMemo(()=>{if(o&&t.selectedResidueHash)return o.findResidueByHash(t.selectedResidueHash)},[t.selectedResidueHash]);return T(rn,{children:[p("div",{children:t.simpleStuffy}),T("div",{className:"flex flex-col items-center h-full p-5",ref:c,children:[T("div",{className:"relative h-full min-w-full",children:[p("svg",{ref:i}),f&&T("div",{className:"\r text-xs p-4\r absolute bottom-[10px] right-[10px]\r w-[50%] h-[100px] bg-indigo-400\r overflow-auto text-white rounded-lg\r ",children:[T("div",{children:["Chain: ",f.polymerChainIdentifier]}),T("div",{children:["Residue: ",f.name,":",f.sequenceNumber]}),T("div",{children:["Interactions:"," ",f.interactions.map(u=>p("div",{children:JSON.stringify(u)}))]})]})]}),p("div",{ref:s,style:{position:"absolute",opacity:0,background:"#fff"}})]})]})}const hn=async({pdbId:t,pdbText:e})=>await(await fetch(`http://localhost:8001?id=${t}`)).json(),mn=(t,e)=>{let r=0;return t.filter(i=>{if(i.kind===D.RNA){const s=e.filter(u=>u.chain_id===i.chainIdentifier);if(s.length===0)throw new Error("Could not retrieve secondary structure for chain "+i.chainIdentifier);const c=s[0];let o=0;const l=Jt(c.coords.map(u=>u[0])),f=r!=0?r-l+ue*3:0;for(let u=0;u<Math.min(i.residues.length,c.coords.length);u++){console.log(c,i.residues.length,u,i.residues[u],i.residues);const[I,y]=c.coords[u],M=I+f;o=Math.max(o,M),i.residues[u].initial_x=M,i.residues[u].initial_y=y}r=Math.max(r,o)}}),t},ht=new Set,Ue=()=>{const t=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));return ht.has(t)?Ue():(ht.add(t),t)};class mt{constructor(e){S(this,"file");e!==void 0&&(this.file=e)}async readData(){if(this.file==null)throw Error("file not provided");let e=await this.file.text();return this.format(e)}format(e){return{raw:this.formatText(e),polymers:this.formatPolymers(e)}}formatText(e){return e.split(`
`).map((r,i)=>i.toString()+". "+r).join(`
`)}formatPolymers(e){let r=[];const i=()=>({chainIdentifier:"",residues:[],kind:D.Unknown}),s=()=>new tn,c=()=>{l.hash=Ue(),o.residues.push(l)};let o=i(),l=s();const f=A=>{let g={[D.DNA]:0,[D.RNA]:0,[D.Protein]:0};return A===void 0?g:[g,Object.keys(A).reduce((O,P)=>A[O]>A[P]?O:P)]};let u=f(),I=[],y={chains:[],rotations:[],translations:[m.infinity()]},M=!1;const j=()=>{y={chains:[],rotations:[],translations:[m.infinity()]}};let x=!1,w=0,C=0;const b=e.split(`
`);for(let A=0;A<b.length;A++){const g=b[A];if(!(x&&C>1)){if(g.startsWith("NUMMDL")&&(x=!0,w=parseInt(g.slice(10,14).trim()),console.log("NUMBER OF MODELS:",w)),g.startsWith("MODEL")&&(C=parseInt(g.slice(11,14).trim())),g.startsWith("ATOM")||g.startsWith("HETATM")){let O=parseFloat(g.slice(30,38).trim()),P=parseFloat(g.slice(38,46).trim()),v=parseFloat(g.slice(46,54).trim()),R=g.slice(12,16).trim(),Z=g.slice(17,20).trim(),L=g.slice(76,78).trim(),k=parseInt(g.slice(22,26).trim()),V=g.slice(21,22);o.chainIdentifier=V;const $={coords:new xe(O,P,v),name:R,element:L,residueName:Z,residueSequenceNumber:k};u[nn($)]++,l.sequenceNumber===-1&&(l.name=$.residueName,l.sequenceNumber=k,l.polymerChainIdentifier=V),k!==l.sequenceNumber&&(c(),l=s(),l.name=$.residueName,l.sequenceNumber=k,l.polymerChainIdentifier=V),l.atoms.push($)}if(g.startsWith("TER")||A===b.length-1){c();let[O,P]=f(u);u=O,o.kind=P,o=ct(o),r.push(o),o=i(),l=s()}if(g.startsWith("REMARK 350")){if(M=!0,["REMARK 350 APPLY THE FOLLOWING TO CHAINS: ","REMARK 350                    AND CHAINS:"].forEach((P,v)=>{if(g.startsWith(P)){let R=g.trim().slice(P.length-1,g.length).toString().replaceAll(" ","").split(",");v===0&&(j(),y.chains.length>0&&I.push(y)),R.length>0&&y.chains.push(...R)}}),g.startsWith("REMARK 350   BIOMT")){let v=g.replace("REMARK 350   BIOMT","").match(new RegExp(/(\d{1})\s*(\d{1})\s*([+-]?[0-9]*[.]?[0-9]+)\s*([+-]?[0-9]*[.]?[0-9]+)\s*([+-]?[0-9]*[.]?[0-9]+)\s*([+-]?[0-9]*[.]?[0-9]+)/));if(v!=null&&v.length===6+1){v=v.slice(1);let R=parseInt(v[1])-1,Z=parseInt(v[0])-1,L=[parseFloat(v[2]),parseFloat(v[3]),parseFloat(v[4])],k=parseFloat(v[5]);typeof y.translations[R]=="undefined"&&(y.translations[R]=m.infinity()),y.translations[R].setIndex(Z,k),Array.isArray(y.rotations[R])||(y.rotations[R]=[]),y.rotations[R][Z]=L}}}else M&&(I.push(y),j()),M=!1}}return I.forEach(A=>{const g=r.filter(v=>A.chains.indexOf(v.chainIdentifier)!==-1),O=A.rotations.slice(1),P=A.translations.slice(1);O.forEach((v,R)=>{g.forEach(Z=>{let L=Qt(Z,{includeNonEnumerable:!0});L.chainIdentifier=L.chainIdentifier+(R+1).toString(),L.generatedFromTransform=!0,L.residues.forEach((k,V)=>{k.polymerChainIdentifier=L.chainIdentifier,k.atoms.forEach(($,se)=>{let B=$.coords.toVec(),q=m.infinity();console.log("Coorinates before:",B),q.x=B.x*v[0][0]+B.y*v[0][1]+B.z*v[0][2],q.y=B.x*v[1][0]+B.y*v[1][1]+B.z*v[1][2],q.z=B.x*v[2][0]+B.y*v[2][1]+B.z*v[2][2];const Ne=P[R];q=q.add(Ne),console.log("Coords after:",q),console.log("Distance between atoms: ",q.distanceTo(B)),$.coords=q.toCoord(),k.atoms[se]=$}),k.hash=Ue(),L.residues[V]=k}),L=ct(L),r.push(L)})})}),console.log("Transformations:",I),console.log("Result after translation",r),r}}const pn=async t=>await(await fetch(`https://files.rcsb.org/download/${t}.pdb`)).text();function yn(){var j;const[t,e]=Y.exports.useContext(ve),r=()=>{e({type:"isLoading",payload:!0})},i=()=>{e({type:"isLoading",payload:!1})},s=x=>{e({type:"pdb",payload:x})},c=x=>{e({type:"currentPDBId",payload:x})},o=x=>{e({type:"polymers",payload:x})},l=()=>{e({type:"resetState",payload:null})},f=async x=>{l(),r();const w=new mt().format(await pn(x));s(w);const C=await hn({pdbId:x});mn(w.polymers,C),o(w.polymers),c(x),i()};Y.exports.useEffect(()=>{const w=new URLSearchParams(window.location.search).get("id");console.log("ID",w),w!==null&&f(w)},[]);const u=async x=>{var C;const w=(C=x.target.files)==null?void 0:C.item(0);if(w!==null){l(),r(),console.time("TIME_TO_PARSE_EVERYTHING"),console.time("TIME_TO_PARSE_PDB");const b=await new mt(w).readData();console.timeEnd("TIME_TO_PARSE_PDB"),s(b),o(b.polymers),console.timeEnd("TIME_TO_PARSE_EVERYTHING"),setTimeout(i,2e3)}};let I;t.polymers.length>0&&(I=T("div",{className:"mt-5",children:[p("div",{className:"mb-1",children:"Provided input file"}),p("textarea",{className:"w-full text-sm border border-blue-100 h-96",value:(j=t.pdb)==null?void 0:j.raw,readOnly:!0})]}));const y=Y.exports.useRef(null),M=()=>{var w;const x=(w=y.current)==null?void 0:w.value;x&&f(x)};return T("div",{className:"max-h-screen p-5 overflow-auto break-words",children:[!t.isLoading&&T("div",{children:[t.error.length>0&&p("div",{className:"mb-4",children:T("div",{className:"text-lg font-bold text-red-700",children:["Something went wrong: ",t.error]})}),t.pdb===void 0&&p("div",{className:"p-2 mb-4 text-sm text-gray-600 bg-red-200",children:"Choose a PDB file which contains DNA/RNA with Proteins"}),T("div",{children:[t.currentPDBId.length>0&&T("div",{className:"mb-4",children:["Currently selected PDB ID:",p("b",{children:t.currentPDBId.toUpperCase()})]}),T("div",{className:"mb-4",children:[T("div",{className:"mb-2 font-bold text-gray-600 text-normal",children:["Enter PDB file ID:",T("div",{className:"text-xs font-normal",children:["PDB file should contain ",p("b",{children:"DNA/RNA"})," structures"]})]}),T("div",{className:"flex flex-row max-w-full",children:[p("input",{onKeyPress:x=>{x.key==="Enter"&&M()},ref:y,placeholder:"1ZS4",className:"block px-2 py-1 transition-all border border-r-0 border-indigo-300 rounded rounded-tr-none rounded-br-none outline-none ring-indigo-200 focus:ring-2 outline-0"}),p("button",{onClick:M,className:"bg-indigo-400 border-l-0 text-white font-bold text-sm ring-indigo-200 focus:ring-2 hover:bg-indigo-600 transition-all w-[100px]  block rounded rounded-tl-none rounded-bl-none border border-indigo-300",children:"GO"})]})]}),T("div",{className:"mb-2 font-bold text-gray-600 text-normal",children:["Or choose a PDB file to display:",T("div",{className:"text-xs font-normal",children:["PDB file should contain ",p("b",{children:"DNA/RNA"})," structures"]})]}),p("input",{type:"file",onChange:u,className:"max-w-full"})]})]}),I,t.pdb&&T("div",{children:["Polymers from input:",t.polymers.map(({residues:x,chainIdentifier:w,kind:C},b)=>T("div",{className:"ml-2",children:["Chain:"," ",T("b",{children:[w," (",C,")"]}),p("div",{className:"ml-2",children:x.map((A,g)=>T("span",{children:[A.name," \xA0"]},g))})]},b))]})]})}const gn=()=>T("div",{className:"flex flex-col items-center gap-1",children:[p("div",{className:"text-white font-bold",children:"Loading"}),T("div",{className:"lds-roller",children:[p("div",{}),p("div",{}),p("div",{}),p("div",{}),p("div",{}),p("div",{}),p("div",{}),p("div",{})]})]});var pt="/assets/naview.6583db20.wasm",a=typeof a!="undefined"?a:{};a.locateFile=function(t,e){return pt};var yt=Object.assign({},a),Te=(t,e)=>{throw e},Be=typeof window=="object",ce=typeof importScripts=="function",gt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",wt=!Be&&!gt&&!ce;if(a.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var G="";function wn(t){return a.locateFile?a.locateFile(t,G):G+t}var _e,de,fe;function xt(t){if(t instanceof Qe)return;let e=t;t&&typeof t=="object"&&t.stack&&(e=[t,t.stack]),N("exiting due to exception: "+e)}var We,Ie,Ge;if(gt){if(!(typeof process=="object"&&typeof require=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");ce?G=require("path").dirname(G)+"/":G=__dirname+"/",Ge=()=>{Ie||(We=require("fs"),Ie=require("path"))},_e=function(e,r){return Ge(),e=Ie.normalize(e),We.readFileSync(e,r?void 0:"utf8")},fe=t=>{var e=_e(t,!0);return e.buffer||(e=new Uint8Array(e)),h(e.buffer),e},de=(t,e,r)=>{Ge(),t=Ie.normalize(t),We.readFile(t,function(i,s){i?r(i):e(s.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),typeof et!="undefined"&&(et.exports=a),process.on("uncaughtException",function(t){if(!(t instanceof Qe))throw t}),process.on("unhandledRejection",function(t){throw t}),Te=(t,e)=>{if(Ve())throw process.exitCode=t,e;xt(e),process.exit(t)},a.inspect=function(){return"[Emscripten Module object]"}}else if(wt){if(typeof process=="object"&&typeof require=="function"||typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");typeof read!="undefined"&&(_e=function(e){return read(e)}),fe=function(e){let r;return typeof readbuffer=="function"?new Uint8Array(readbuffer(e)):(r=read(e,"binary"),h(typeof r=="object"),r)},de=function(e,r,i){setTimeout(()=>r(fe(e)),0)},typeof scriptArgs!="undefined"?scriptArgs:typeof arguments!="undefined"&&arguments,typeof quit=="function"&&(Te=(t,e)=>{xt(e),quit(t)}),typeof print!="undefined"&&(typeof console=="undefined"&&(console={}),console.log=print,console.warn=console.error=typeof printErr!="undefined"?printErr:print)}else if(Be||ce){if(ce?G=self.location.href:typeof document!="undefined"&&document.currentScript&&(G=document.currentScript.src),G.indexOf("blob:")!==0?G=G.substr(0,G.replace(/[?#].*/,"").lastIndexOf("/")+1):G="",!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");_e=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ce&&(fe=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),de=(t,e,r)=>{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=()=>{if(i.status==200||i.status==0&&i.response){e(i.response);return}r()},i.onerror=r,i.send(null)}}else throw new Error("environment detection error");var Ae=a.print||console.log.bind(console),N=a.printErr||console.warn.bind(console);Object.assign(a,yt);yt=null;$n();a.arguments;K("arguments","arguments_");a.thisProgram;K("thisProgram","thisProgram");a.quit&&(Te=a.quit);K("quit","quit_");h(typeof a.memoryInitializerPrefixURL=="undefined","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");h(typeof a.pthreadMainPrefixURL=="undefined","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");h(typeof a.cdInitializerPrefixURL=="undefined","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");h(typeof a.filePackagePrefixURL=="undefined","Module.filePackagePrefixURL option was removed, use Module.locateFile instead");h(typeof a.read=="undefined","Module.read option was removed (modify read_ in JS)");h(typeof a.readAsync=="undefined","Module.readAsync option was removed (modify readAsync in JS)");h(typeof a.readBinary=="undefined","Module.readBinary option was removed (modify readBinary in JS)");h(typeof a.setWindowTitle=="undefined","Module.setWindowTitle option was removed (modify setWindowTitle in JS)");h(typeof a.TOTAL_MEMORY=="undefined","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");K("read","read_");K("readAsync","readAsync");K("readBinary","readBinary");K("setWindowTitle","setWindowTitle");h(!wt,"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable.");function re(t){re.shown||(re.shown={}),re.shown[t]||(re.shown[t]=1,N(t))}function K(t,e){Object.getOwnPropertyDescriptor(a,t)||Object.defineProperty(a,t,{configurable:!0,get:function(){U("Module."+t+" has been replaced with plain "+e+" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}})}function xn(t){Object.getOwnPropertyDescriptor(a,t)&&U("`Module."+t+"` was supplied but `"+t+"` not included in INCOMING_MODULE_JS_API")}function vt(t,e){var r="'"+t+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)";return e&&(r+=". Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you"),r}function bt(t,e){Object.getOwnPropertyDescriptor(a,t)||Object.defineProperty(a,t,{configurable:!0,get:function(){U(vt(t,e))}})}function n(t,e){Object.getOwnPropertyDescriptor(a,t)||(a[t]=()=>U(vt(t,e)))}var he;a.wasmBinary&&(he=a.wasmBinary);K("wasmBinary","wasmBinary");var vn=a.noExitRuntime||!0;K("noExitRuntime","noExitRuntime");typeof WebAssembly!="object"&&U("no native wasm support detected");var He,me=!1;function h(t,e){t||U("Assertion failed"+(e?": "+e:""))}var Et=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function Tt(t,e,r){for(var i=e+r,s=e;t[s]&&!(s>=i);)++s;if(s-e>16&&t.subarray&&Et)return Et.decode(t.subarray(e,s));for(var c="";e<s;){var o=t[e++];if(!(o&128)){c+=String.fromCharCode(o);continue}var l=t[e++]&63;if((o&224)==192){c+=String.fromCharCode((o&31)<<6|l);continue}var f=t[e++]&63;if((o&240)==224?o=(o&15)<<12|l<<6|f:((o&248)!=240&&re("Invalid UTF-8 leading byte 0x"+o.toString(16)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),o=(o&7)<<18|l<<12|f<<6|t[e++]&63),o<65536)c+=String.fromCharCode(o);else{var u=o-65536;c+=String.fromCharCode(55296|u>>10,56320|u&1023)}}return c}function bn(t,e){return t?Tt(pe,t,e):""}typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le");var _t,pe,Q,je;function En(t){a.HEAP8=_t=new Int8Array(t),a.HEAP16=new Int16Array(t),a.HEAP32=Q=new Int32Array(t),a.HEAPU8=pe=new Uint8Array(t),a.HEAPU16=new Uint16Array(t),a.HEAPU32=je=new Uint32Array(t),a.HEAPF32=new Float32Array(t),a.HEAPF64=new Float64Array(t)}var $e=5242880;a.TOTAL_STACK&&h($e===a.TOTAL_STACK,"the stack size can no longer be determined at runtime");var qe=a.INITIAL_MEMORY||16777216;K("INITIAL_MEMORY","INITIAL_MEMORY");h(qe>=$e,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+qe+"! (TOTAL_STACK="+$e+")");h(typeof Int32Array!="undefined"&&typeof Float64Array!="undefined"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support");h(!a.wasmMemory,"Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally");h(qe==16777216,"Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically");var Me;function It(){var t=Je();h((t&3)==0),Q[t>>2]=34821223,Q[t+4>>2]=2310721022,Q[0]=1668509029}function ye(){if(!me){var t=Je(),e=je[t>>2],r=je[t+4>>2];(e!=34821223||r!=2310721022)&&U("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+r.toString(16)+" 0x"+e.toString(16)),Q[0]!==1668509029&&U("Runtime error: The application has corrupted its heap memory area (address zero)!")}}(function(){var t=new Int16Array(1),e=new Int8Array(t.buffer);if(t[0]=25459,e[0]!==115||e[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)"})();var At=[],Mt=[],St=[],Ye=!1,Ct=!1,Tn=0;function Ve(){return vn||Tn>0}function _n(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Sn(a.preRun.shift());Xe(At)}function In(){ye(),h(!Ye),Ye=!0,Xe(Mt)}function An(){ye(),Ct=!0}function Mn(){if(ye(),a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)Nn(a.postRun.shift());Xe(St)}function Sn(t){At.unshift(t)}function Cn(t){Mt.unshift(t)}function Nn(t){St.unshift(t)}h(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");h(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");h(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");h(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var ie=0,ae=null,ge=null,we={};function kn(t){ie++,a.monitorRunDependencies&&a.monitorRunDependencies(ie),t?(h(!we[t]),we[t]=1,ae===null&&typeof setInterval!="undefined"&&(ae=setInterval(function(){if(me){clearInterval(ae),ae=null;return}var e=!1;for(var r in we)e||(e=!0,N("still waiting on run dependencies:")),N("dependency: "+r);e&&N("(end of list)")},1e4))):N("warning: run dependency added without ID")}function On(t){if(ie--,a.monitorRunDependencies&&a.monitorRunDependencies(ie),t?(h(we[t]),delete we[t]):N("warning: run dependency removed without ID"),ie==0&&(ae!==null&&(clearInterval(ae),ae=null),ge)){var e=ge;ge=null,e()}}a.preloadedImages={};a.preloadedAudios={};function U(t){a.onAbort&&a.onAbort(t),t="Aborted("+t+")",N(t),me=!0;var e=new WebAssembly.RuntimeError(t);throw e}var H={error:function(){U("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){H.error()},createDataFile:function(){H.error()},createPreloadedFile:function(){H.error()},createLazyFile:function(){H.error()},open:function(){H.error()},mkdev:function(){H.error()},registerDevice:function(){H.error()},analyzePath:function(){H.error()},loadFilesFromDB:function(){H.error()},ErrnoError:function(){H.error()}};a.FS_createDataFile=H.createDataFile;a.FS_createPreloadedFile=H.createPreloadedFile;var Rn="data:application/octet-stream;base64,";function Nt(t){return t.startsWith(Rn)}function Ke(t){return t.startsWith("file://")}function te(t,e){return function(){var r=t,i=e;return e||(i=a.asm),h(Ye,"native function `"+r+"` called before runtime initialization"),h(!Ct,"native function `"+r+"` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i[t]||h(i[t],"exported native function `"+r+"` not found"),i[t].apply(null,arguments)}}var F;F="naview.wasm";Nt(F)||(F=wn(F));function kt(t){try{if(t==F&&he)return new Uint8Array(he);if(fe)return fe(t);throw"both async and sync fetching of the wasm failed"}catch(e){U(e)}}function Ln(){if(!he&&(Be||ce)){if(typeof fetch=="function"&&!Ke(F))return fetch(F,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+F+"'";return t.arrayBuffer()}).catch(function(){return kt(F)});if(de)return new Promise(function(t,e){de(F,function(r){t(new Uint8Array(r))},e)})}return Promise.resolve().then(function(){return kt(F)})}function Dn(){var t={env:Rt,wasi_snapshot_preview1:Rt};function e(l,f){var u=l.exports;a.asm=u,He=a.asm.memory,h(He,"memory not found in wasm exports"),En(He.buffer),Me=a.asm.__indirect_function_table,h(Me,"table not found in wasm exports"),Cn(a.asm.__wasm_call_ctors),On("wasm-instantiate")}kn("wasm-instantiate");var r=a;function i(l){h(a===r,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),r=null,e(l.instance)}function s(l){return Ln().then(function(f){return WebAssembly.instantiate(f,t)}).then(function(f){return f}).then(l,function(f){N("failed to asynchronously prepare wasm: "+f),Ke(F)&&N("warning: Loading from a file URI ("+F+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),U(f)})}function c(){return!he&&typeof WebAssembly.instantiateStreaming=="function"&&!Nt(F)&&!Ke(F)&&typeof fetch=="function"?fetch(F,{credentials:"same-origin"}).then(function(l){var f=WebAssembly.instantiateStreaming(l,t);return f.then(i,function(u){return N("wasm streaming compile failed: "+u),N("falling back to ArrayBuffer instantiation"),s(i)})}):s(i)}if(a.instantiateWasm)try{var o=a.instantiateWasm(t,e);return o}catch(l){return N("Module.instantiateWasm callback failed with error: "+l),!1}return c(),{}}function Xe(t){for(;t.length>0;){var e=t.shift();if(typeof e=="function"){e(a);continue}var r=e.func;typeof r=="number"?e.arg===void 0?Ot(r)():Ot(r)(e.arg):r(e.arg===void 0?null:e.arg)}}var Se=[];function Ot(t){var e=Se[t];return e||(t>=Se.length&&(Se.length=t+1),Se[t]=e=Me.get(t)),h(Me.get(t)==e,"JavaScript-side Wasm function table mirror is out of date!"),e}function Fn(t,e,r){pe.copyWithin(t,e,e+r)}function Pn(t){U("Cannot enlarge memory arrays to size "+t+" bytes (OOM). Either (1) compile with  -s INITIAL_MEMORY=X  with X higher than the current value "+_t.length+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function zn(t){pe.length,t=t>>>0,Pn(t)}function Un(t){Kn(t)}var ne={buffers:[null,[],[]],printChar:function(t,e){var r=ne.buffers[t];h(r),e===0||e===10?((t===1?Ae:N)(Tt(r,0)),r.length=0):r.push(e)},varargs:void 0,get:function(){h(ne.varargs!=null),ne.varargs+=4;var t=Q[ne.varargs-4>>2];return t},getStr:function(t){var e=bn(t);return e},get64:function(t,e){return t>=0?h(e===0):h(e===-1),t}};function Bn(t){return U("it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM"),0}function Wn(t,e,r,i,s){U("it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM")}function Gn(){qn();var t=ne.buffers;t[1].length&&ne.printChar(1,10),t[2].length&&ne.printChar(2,10)}function Hn(t,e,r,i){for(var s=0,c=0;c<r;c++){var o=Q[e>>2],l=Q[e+4>>2];e+=8;for(var f=0;f<l;f++)ne.printChar(t,pe[o+f]);s+=l}return Q[i>>2]=s,0}function jn(t){}function $n(){xn("fetchSettings")}var Rt={emscripten_memcpy_big:Fn,emscripten_resize_heap:zn,exit:Un,fd_close:Bn,fd_seek:Wn,fd_write:Hn,setTempRet0:jn};Dn();a.___wasm_call_ctors=te("__wasm_call_ctors");a._secondaryStruct=te("secondaryStruct");a.___errno_location=te("__errno_location");var qn=a.___stdio_exit=te("__stdio_exit"),Lt=a._emscripten_stack_init=function(){return(Lt=a._emscripten_stack_init=a.asm.emscripten_stack_init).apply(null,arguments)};a._emscripten_stack_get_free=function(){return(a._emscripten_stack_get_free=a.asm.emscripten_stack_get_free).apply(null,arguments)};a._emscripten_stack_get_base=function(){return(a._emscripten_stack_get_base=a.asm.emscripten_stack_get_base).apply(null,arguments)};var Je=a._emscripten_stack_get_end=function(){return(Je=a._emscripten_stack_get_end=a.asm.emscripten_stack_get_end).apply(null,arguments)};a.stackSave=te("stackSave");a.stackRestore=te("stackRestore");a.stackAlloc=te("stackAlloc");a.dynCall_jiji=te("dynCall_jiji");n("intArrayFromString",!1);n("intArrayToString",!1);n("ccall",!1);n("cwrap",!1);n("setValue",!1);n("getValue",!1);n("allocate",!1);n("UTF8ArrayToString",!1);n("UTF8ToString",!1);n("stringToUTF8Array",!1);n("stringToUTF8",!1);n("lengthBytesUTF8",!1);n("stackTrace",!1);n("addOnPreRun",!1);n("addOnInit",!1);n("addOnPreMain",!1);n("addOnExit",!1);n("addOnPostRun",!1);n("writeStringToMemory",!1);n("writeArrayToMemory",!1);n("writeAsciiToMemory",!1);n("addRunDependency",!0);n("removeRunDependency",!0);n("FS_createFolder",!1);n("FS_createPath",!0);n("FS_createDataFile",!0);n("FS_createPreloadedFile",!0);n("FS_createLazyFile",!0);n("FS_createLink",!1);n("FS_createDevice",!0);n("FS_unlink",!0);n("getLEB",!1);n("getFunctionTables",!1);n("alignFunctionTables",!1);n("registerFunctions",!1);n("addFunction",!1);n("removeFunction",!1);n("getFuncWrapper",!1);n("prettyPrint",!1);n("dynCall",!1);n("getCompilerSetting",!1);n("print",!1);n("printErr",!1);n("getTempRet0",!1);n("setTempRet0",!1);n("callMain",!1);n("abort",!1);n("keepRuntimeAlive",!1);n("zeroMemory",!1);n("stringToNewUTF8",!1);n("abortOnCannotGrowMemory",!1);n("emscripten_realloc_buffer",!1);n("ENV",!1);n("withStackSave",!1);n("ERRNO_CODES",!1);n("ERRNO_MESSAGES",!1);n("setErrNo",!1);n("inetPton4",!1);n("inetNtop4",!1);n("inetPton6",!1);n("inetNtop6",!1);n("readSockaddr",!1);n("writeSockaddr",!1);n("DNS",!1);n("getHostByName",!1);n("Protocols",!1);n("Sockets",!1);n("getRandomDevice",!1);n("traverseStack",!1);n("convertFrameToPC",!1);n("UNWIND_CACHE",!1);n("saveInUnwindCache",!1);n("convertPCtoSourceLocation",!1);n("readAsmConstArgsArray",!1);n("readAsmConstArgs",!1);n("mainThreadEM_ASM",!1);n("jstoi_q",!1);n("jstoi_s",!1);n("getExecutableName",!1);n("listenOnce",!1);n("autoResumeAudioContext",!1);n("dynCallLegacy",!1);n("getDynCaller",!1);n("dynCall",!1);n("callRuntimeCallbacks",!1);n("wasmTableMirror",!1);n("setWasmTableEntry",!1);n("getWasmTableEntry",!1);n("handleException",!1);n("runtimeKeepalivePush",!1);n("runtimeKeepalivePop",!1);n("callUserCallback",!1);n("maybeExit",!1);n("safeSetTimeout",!1);n("asmjsMangle",!1);n("asyncLoad",!1);n("alignMemory",!1);n("mmapAlloc",!1);n("reallyNegative",!1);n("unSign",!1);n("reSign",!1);n("formatString",!1);n("PATH",!1);n("PATH_FS",!1);n("SYSCALLS",!1);n("getSocketFromFD",!1);n("getSocketAddress",!1);n("JSEvents",!1);n("registerKeyEventCallback",!1);n("specialHTMLTargets",!1);n("maybeCStringToJsString",!1);n("findEventTarget",!1);n("findCanvasEventTarget",!1);n("getBoundingClientRect",!1);n("fillMouseEventData",!1);n("registerMouseEventCallback",!1);n("registerWheelEventCallback",!1);n("registerUiEventCallback",!1);n("registerFocusEventCallback",!1);n("fillDeviceOrientationEventData",!1);n("registerDeviceOrientationEventCallback",!1);n("fillDeviceMotionEventData",!1);n("registerDeviceMotionEventCallback",!1);n("screenOrientation",!1);n("fillOrientationChangeEventData",!1);n("registerOrientationChangeEventCallback",!1);n("fillFullscreenChangeEventData",!1);n("registerFullscreenChangeEventCallback",!1);n("registerRestoreOldStyle",!1);n("hideEverythingExceptGivenElement",!1);n("restoreHiddenElements",!1);n("setLetterbox",!1);n("currentFullscreenStrategy",!1);n("restoreOldWindowedStyle",!1);n("softFullscreenResizeWebGLRenderTarget",!1);n("doRequestFullscreen",!1);n("fillPointerlockChangeEventData",!1);n("registerPointerlockChangeEventCallback",!1);n("registerPointerlockErrorEventCallback",!1);n("requestPointerLock",!1);n("fillVisibilityChangeEventData",!1);n("registerVisibilityChangeEventCallback",!1);n("registerTouchEventCallback",!1);n("fillGamepadEventData",!1);n("registerGamepadEventCallback",!1);n("registerBeforeUnloadEventCallback",!1);n("fillBatteryEventData",!1);n("battery",!1);n("registerBatteryEventCallback",!1);n("setCanvasElementSize",!1);n("getCanvasElementSize",!1);n("demangle",!1);n("demangleAll",!1);n("jsStackTrace",!1);n("stackTrace",!1);n("getEnvStrings",!1);n("checkWasiClock",!1);n("flush_NO_FILESYSTEM",!1);n("writeI53ToI64",!1);n("writeI53ToI64Clamped",!1);n("writeI53ToI64Signaling",!1);n("writeI53ToU64Clamped",!1);n("writeI53ToU64Signaling",!1);n("readI53FromI64",!1);n("readI53FromU64",!1);n("convertI32PairToI53",!1);n("convertU32PairToI53",!1);n("setImmediateWrapped",!1);n("clearImmediateWrapped",!1);n("polyfillSetImmediate",!1);n("uncaughtExceptionCount",!1);n("exceptionLast",!1);n("exceptionCaught",!1);n("ExceptionInfo",!1);n("CatchInfo",!1);n("exception_addRef",!1);n("exception_decRef",!1);n("Browser",!1);n("funcWrappers",!1);n("getFuncWrapper",!1);n("setMainLoop",!1);n("wget",!1);n("FS",!1);n("MEMFS",!1);n("TTY",!1);n("PIPEFS",!1);n("SOCKFS",!1);n("_setNetworkCallback",!1);n("tempFixedLengthArray",!1);n("miniTempWebGLFloatBuffers",!1);n("heapObjectForWebGLType",!1);n("heapAccessShiftForWebGLHeap",!1);n("GL",!1);n("emscriptenWebGLGet",!1);n("computeUnpackAlignedImageSize",!1);n("emscriptenWebGLGetTexPixelData",!1);n("emscriptenWebGLGetUniform",!1);n("webglGetUniformLocation",!1);n("webglPrepareUniformLocationsBeforeFirstUse",!1);n("webglGetLeftBracePos",!1);n("emscriptenWebGLGetVertexAttrib",!1);n("writeGLArray",!1);n("AL",!1);n("SDL_unicode",!1);n("SDL_ttfContext",!1);n("SDL_audio",!1);n("SDL",!1);n("SDL_gfx",!1);n("GLUT",!1);n("EGL",!1);n("GLFW_Window",!1);n("GLFW",!1);n("GLEW",!1);n("IDBStore",!1);n("runAndAbortIfError",!1);n("warnOnce",!1);n("stackSave",!1);n("stackRestore",!1);n("stackAlloc",!1);n("AsciiToString",!1);n("stringToAscii",!1);n("UTF16ToString",!1);n("stringToUTF16",!1);n("lengthBytesUTF16",!1);n("UTF32ToString",!1);n("stringToUTF32",!1);n("lengthBytesUTF32",!1);n("allocateUTF8",!1);n("allocateUTF8OnStack",!1);a.writeStackCookie=It;a.checkStackCookie=ye;bt("ALLOC_NORMAL",!1);bt("ALLOC_STACK",!1);var Ce;function Qe(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}ge=function t(){Ce||Ze(),Ce||(ge=t)};function Yn(){Lt(),It()}function Ze(t){if(ie>0||(Yn(),_n(),ie>0))return;function e(){Ce||(Ce=!0,a.calledRun=!0,!me&&(In(),a.onRuntimeInitialized&&a.onRuntimeInitialized(),h(!a._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),Mn()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),e()},1)):e(),ye()}a.run=Ze;function Vn(){var t=Ae,e=N,r=!1;Ae=N=s=>{r=!0};try{var i=Gn;i&&i()}catch{}Ae=t,N=e,r&&(re("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc."),re("(this may also be due to not including full filesystem support - try building with -s FORCE_FILESYSTEM=1)"))}function Kn(t,e){if(Vn(),Ve()){if(!e){var r="program exited (with status: "+t+"), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)";N(r)}}else An();Xn(t)}function Xn(t){Ve()||(a.onExit&&a.onExit(t),me=!0),Te(t,new Qe(t))}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();Ze();console.log("Naview url:",pt);(async()=>{a.onRuntimeInitialized=async t=>{console.log(a)}})();function Jn(){const t=Y.exports.useContext(ve)[0];return T("div",{className:"flex flex-row w-full",children:[t.isLoading===!0&&p("div",{className:"fixed top-0 left-0 z-50 flex items-center justify-center w-screen h-full min-h-screen",style:{backgroundColor:"rgba(0,0,0,0.75)"},children:p(gn,{})}),p("div",{className:"z-10 w-9/12 h-screen min-h-full bg-indigo-200",children:p(dn,{})}),p("div",{className:"z-10 w-3/12",children:p(yn,{})})]})}function Qn({children:t}){return p(sn,{children:t})}const Zn="modulepreload",Dt={},er="/",tr=function(e,r){return!r||r.length===0?e():Promise.all(r.map(i=>{if(i=`${er}${i}`,i in Dt)return;Dt[i]=!0;const s=i.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${c}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":Zn,s||(o.as="script",o.crossOrigin=""),o.href=i,document.head.appendChild(o),s)return new Promise((l,f)=>{o.addEventListener("load",l),o.addEventListener("error",f)})})).then(()=>e())},nr=t=>{t&&t instanceof Function&&tr(()=>import("./web-vitals.d62816c8.js"),[]).then(({getCLS:e,getFID:r,getFCP:i,getLCP:s,getTTFB:c})=>{e(t),r(t),i(t),s(t),c(t)})};Zt.render(p(Fe.StrictMode,{children:p(Qn,{children:p(Jn,{})})}),document.getElementById("root"));nr()});export default rr();
